Implement the following plan:

# Plano: Distribui√ß√£o via Homebrew

## Contexto

O Safo est√° completo (3 fases) mas n√£o √© instal√°vel por outros. Precisamos de um caminho de distribui√ß√£o para a equipa: `brew install` que instale o .app bundle (com URL scheme) e o CLI (`safo`).

## Estrat√©gia

**Uma cask** no tap `andrefurt/homebrew-safo` que instala tudo: Safo.app em /Applications e o bin√°rio `safo` no PATH. Uma cask (n√£o formula) porque precisamos distribuir o .app bundle pr√©-compilado para que o URL scheme `safo://` funcione.

**Code signing**: ad-hoc por agora (free). Utilizadores fazem right-click > Open na primeira vez. Quando/se houver Apple Developer Program, basta mudar o signing no Makefile.

## Implementa√ß√£o

### 1. Makefile no repo safo

Ficheiro: `Makefile`

Targets:
- `build`: `swift build -c release`
- `bundle`: cria estrutura `Safo.app/Contents/{MacOS,Resources,Info.plist}`, copia bin√°rios, ad-hoc sign
- `package`: cria `Safo-{version}.zip` com Safo.app + safo (CLI renomeado)
- `install`: instala localmente (cp .app para /Applications, safo para /usr/local/bin)
- `uninstall`: remove ambos

A estrutura do .app bundle:
```
Safo.app/
‚îî‚îÄ‚îÄ Contents/
    ‚îú‚îÄ‚îÄ Info.plist          (de Resources/Info.plist)
    ‚îú‚îÄ‚îÄ MacOS/
    ‚îÇ   ‚îî‚îÄ‚îÄ Safo            (bin√°rio compilado)
    ‚îî‚îÄ‚îÄ Resources/
```

O CLI binary √© renomeado de `safo-cli` para `safo` na instala√ß√£o.

### 2. Criar repo andrefurt/homebrew-safo

Estrutura:
```
homebrew-safo/
‚îú‚îÄ‚îÄ Casks/
‚îÇ   ‚îî‚îÄ‚îÄ safo.rb
‚îî‚îÄ‚îÄ README.md
```

A cask (`Casks/safo.rb`):
- Descarrega `Safo-{version}.zip` do GitHub Release do repo safo
- Instala `Safo.app` em /Applications
- Instala `safo` binary em PATH via stanza `binary`
- SHA256 do zip para verifica√ß√£o

### 3. Processo de release

Manual por agora (automatiz√°vel com GitHub Actions depois):
1. Bump version no Makefile
2. `make package` (gera o zip)
3. Criar GitHub Release no repo safo, upload o zip
4. Copiar SHA256, atualizar cask no repo homebrew-safo
5. Commit e push no homebrew-safo

### 4. Experi√™ncia do utilizador

```bash
brew tap andrefurt/safo
brew install --cask safo

# Primeira vez: right-click Safo.app > Open (Gatekeeper ad-hoc)
# Depois disso:
safo file.md
```

## Ficheiros a criar/modificar

| Ficheiro | Repo | A√ß√£o |
|----------|------|------|
| `Makefile` | safo | Criar |
| `Casks/safo.rb` | homebrew-safo | Criar |
| `README.md` | homebrew-safo | Criar |

## Verifica√ß√£o

1. `make build` compila sem erros
2. `make bundle` cria .app funcional (abre, renderiza markdown)
3. `make package` gera zip com ambos os artefactos
4. `make install` instala localmente, `safo README.md` abre o app
5. Criar release, testar `brew tap andrefurt/safo && brew install --cask safo` numa m√°quina limpa

## Fora de scope (futuro)

- GitHub Actions para automatizar releases
- Developer ID signing + notariza√ß√£o
- Homebrew bottles (bin√°rios pr√©-compilados para install mais r√°pido)
- Formula separada para quem s√≥ quer o CLI sem o .app


If you need specific details from before exiting plan mode (like exact code snippets, error messages, or content you generated), read the full transcript at: /Users/andrefurt/.claude/projects/-Users-andrefurt-code-safo/92023f7e-249a-4df3-be41-54dff58da4b9.jsonl

---

faz commit e prepara o PR

---

merge o PR

---

cria o release v0.1.0, adicionar readme no github, tags, labels, descri√ß√£o titulo. ficar com a p√°gina completa

---

o que √© o sha? n√£o √© info sensivel? o que falta fazer?

---

sim, cria e faz push

---

basicamente tenho 2 repos agora? e se fizer actualiza√ß√µes os users recebem notifica√ß√£o para fazer update?

---

cria o github action para automatizar

---

este token √© para o homebrew safo ou o safo?

---

sim, merge. Antes disso, preciso que cries a documenta√ß√£o sobre esse processo de release. Talvez colocar no claude.md para n√£o ficar esquecido. decide que melhor sitio por. tamb√©m queria saber qual √© a rela√ß√£o entre o homebrew e o repo normal, o que acontece (trabalho no repo normal se ouver novos updates, actualiza automaticamente o homebrew), explica. e outra coisa, n√£o d√° para mudar o nome do repo homebrew para outra coisa? ser s√≥ safo o publico e o outro ser safo qualquer coisa?

---

cria o secret

---

qual repo fa√ßo isso e em que repo gravo?

---

mas j√° criei essa HOMEBREW_TAP_TOKEN e guardei no repo homebrew

---

e apago o outro do homebrew?

---

j√° est√°, j√° gravei o token

---

antes de testares com uma release, documenta esse processo. documenta o processo de releases e must follow no claude.md se for o sitio mais adequado.

---

sim, testa

---

mas tem que ter acesso aos dois?

---

que permiss√µes dou?

---

j√° actualizei o token, lan√ßa outra vez

---

est√° tudo documentado e protocolado? o que fazer para lan√ßar vers√£o nova, coloca√ß√£o das tags, release notes, etc..? para quando fizeres novamente n√£o te esqueceres

---

como assim numa m√°quina limpa?

---

esquece. como testo o brew install? n√£o tenho vers√µes antigas ou de dev instaladas pois n√£o?

---

n√£o √© a homebrew-safo que instalo?

---

erro: ~ ‚ùØ brew install --cask safo
==> Downloading https://github.com/andrefurt/safo/releases/download/v0.1.1/Safo-
curl: (56) The requested URL returned error: 404

Error: Download failed on Cask 'safo' with message: Download failed: https://github.com/andrefurt/safo/releases/download/v0.1.1/Safo-0.1.1.zip

---

sim, torna publico. pensava que o homebrew-safo era um clone do repo safo mas publico precisamente para as pessoas instalarem. Tens que me explicar o processo e papel do homebrew como se tivesse no secund√°rio

---

==> Downloading https://github.com/andrefurt/safo/releases/download/v0.1.1/Safo-
==> Downloading from https://release-assets.githubusercontent.com/github-product
######################################################################### 100.0%
==> Installing Cask safo
==> Moving App 'Safo.app' to '/Applications/Safo.app'
==> Linking Binary 'safo' to '/opt/homebrew/bin/safo'
üç∫  safo was successfully installed!

---

[Image: source: REDACTED 2026-02-13 at 00.18.00.png]

---

j√° fiz isso e n√£o abre, mostra novamente isso

---

[Image: source: REDACTED 2026-02-13 at 00.18.58.png]

---

~ ‚ùØ xattr -cr /Applications/Safo.app
  xattr -cr /opt/homebrew/bin/safo
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/_CodeSignature/CodeResources'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/_CodeSignature/CodeResources'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/_CodeSignature'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/_CodeSignature'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/MacOS/Safo'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/MacOS/Safo'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/MacOS'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/MacOS'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/Resources'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/Resources'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/Info.plist'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents/Info.plist'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app/Contents'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app'
xattr: [Errno 1] Operation not permitted: '/Applications/Safo.app'

---

isto √© seguro?

---

vamos falar sobre os primeiros bugs e fixes:
- Primeiro, ele abre 2 janelas. corri o safo README.md e abriu duas janelas.
- segundo, tem dois icons de sidebar no topo. n√£o faz sentido. s√≥ precisamos de 1.
- terceiro, o button de copy parece inativo, e devia estar no canto direito da topbar e n√£o no centro.
- quarto actualiza as cores da app: figma dark mode: https://www.figma.REDACTED?node-id=119-869&t=aCSjVNaFWH3V6iRv-4
figma light:https://www.figma.REDACTED?node-id=119-1038&t=aCSjVNaFWH3V6iRv-4 . N√£o uses cores arbitrarias, segue os nossos standards.
- Sidebar animation: queria que ao clicar na sidebar collapsed, a sidebar expandia de uma forma muito natural e organica ao estilo da apple. os icons s√£o phosphor.

mostra-me um plano e pensa antes de executar.

---

[Image: source: REDACTED 2026-02-13 at 00.21.26.png]